theme_void()
ggplot(filter(map2016, Nation=="Left Coast", Lat>48, Long>(-122)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc, Lat>48), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, Nation=="Left Coast", Lat>48.5, Long>(-122)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc, Lat>48.5), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, Nation=="Left Coast", Lat>46, Long>(-122)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc, Lat>46), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, Nation=="Left Coast", Lat>47, Long>(-122)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc, Lat>47), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, Nation=="Left Coast", Lat>46, Long>(-122)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc, Lat>46), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, Nation=="Left Coast", Lat>45, Long>(-122)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc, Lat>45), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, Nation=="Left Coast", Lat<45, Long>(-122)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc, Lat<45), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, Nation=="Left Coast", Lat<45, Long>(-123)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc, Lat<45), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, Nation=="Left Coast", Lat<45, Long>(-125)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc, Lat<45), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, Nation=="Left Coast", Lat<45, Long>(-125)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
# geom_path(data=filter(lc, Lat<45), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, Nation=="Left Coast", Lat<45, Long>(-125)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc, Lat<45), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, Nation=="Left Coast", Long>(-125)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
lc <- read.csv("lc.csv")
head(lc)
lc <- read.csv("lc.csv") %>% select(-X)
ggplot(filter(map2016, Nation=="Left Coast", Long>(-125)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
lc <- read.csv("lc.csv") %>% select(-X)
ggplot(filter(map2016, Nation=="Left Coast", Long>(-125)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(lc), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
summary(nations)
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=diff_2016), color="white", size=.1) +
# geom_polygon(data=states, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_polygon(data=country, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_path(data=nations, aes(Long, Lat, group=Group), colour = "black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
country <- map_data("usa") # us border
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=diff_2016), color="white", size=.1) +
# geom_polygon(data=states, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_polygon(data=country, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_path(data=nations, aes(Long, Lat, group=Group), colour = "black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
nations <- nations %>% arrange(Nation, Group, Order)
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=diff_2016), color="white", size=.1) +
# geom_polygon(data=states, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_polygon(data=country, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_path(data=nations, aes(Long, Lat, group=Group), colour = "black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=Nation, alpha=diff_2016), colour = "white", size=.1) +
coord_map("bonne", param=45) +
theme_void()
sc <- nations %>% filter(NationCode=="SC") %>% arrange(-Long)
head(sc)
ggplot(filter(map2016, Nation=="Left Coast", Long>(-125)), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(sc), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, NationCode=="SC"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(sc), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
write.csv(sc, file="sc.csv")
sc <- read.csv("sc.csv") %>% select(-X)
sc <- read.csv("sc.csv")
ggplot(filter(map2016, NationCode=="SC"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(sc), colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
head(sc)
ggplot(filter(map2016, NationCode=="SC"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(sc), aes(order=n),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
sc <- read.csv("sc.csv") %>% arrange(n)
ggplot(filter(map2016, NationCode=="SC"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(sc),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
sc <- read.csv("sc.csv") %>% arrange(n)
ggplot(filter(map2016, NationCode=="SC"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(sc),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
en <- nations %>% filter(NationCode=="EN")
test <- dist(select(en, Long, Lat), method = "euclidean", upper = FALSE, p = 2)
test <- as.matrix(test)
en$n <- sort.int(test[1,], index.return=TRUE)$ix
head(en)
en <- en %>% arrange(n)
ggplot(filter(map2016, NationCode=="EN"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(en),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
en <- nations %>% filter(NationCode=="EN")
ggplot(filter(map2016, NationCode=="EN"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(en),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
en <- nations %>% filter(NationCode=="EN") %>% arrange(Long)
ggplot(filter(map2016, NationCode=="EN"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(en),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
en <- nations %>% filter(NationCode=="EN") %>% arrange(Long)
en <- nations %>% filter(NationCode=="EN")
head(en)
ggplot(filter(map2016, NationCode=="EN"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(en),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
en <- nations %>% filter(NationCode=="EN") %>% arrange(Order)
ggplot(filter(map2016, NationCode=="EN"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(en),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
en <- nations %>% filter(NationCode=="EN") %>% arrange(County)
ggplot(filter(map2016, NationCode=="EN"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(en),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
load("~/Box Sync/Personal/polls2016/nations.Rda")
head(nations)
head(map2016)
en <- nations %>% filter(NationCode=="EN") %>% arrange(Lat)
ggplot(filter(map2016, NationCode=="EN"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(en),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
en <- nations %>% filter(NationCode=="EN") %>% arrange(Long)
ggplot(filter(map2016, NationCode=="EN"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(en),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
write.csv(en, file="en.csv")
load("~/Box Sync/Personal/polls2016/nations.Rda")
load("~/Box Sync/Personal/polls2016/map2016.Rda")
en <- nations %>% filter(NationCode=="EN") %>% arrange(Long)
library(tidyverse)
library(maps)
library(geosphere)
library(RColorBrewer)
library(scales)
country <- map_data("usa") # us border
states <- map_data("state") # state borders
en <- nations %>% filter(NationCode=="EN") %>% arrange(Long)
ggplot(filter(map2016, NationCode=="EN"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(en),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
filter(en, Order==52207)
summary(nations)
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=Nation, alpha=diff_2016), colour = "white", size=.1) +
coord_map("bonne", param=45) +
theme_void()
ds <- nations %>% filter(NationCode=="DS") %>% arrange(Long)
test <- dist(select(en, Long, Lat), method = "euclidean", upper = FALSE, p = 2)
test <- as.matrix(test)
ds$n <- sort.int(test[1,], index.return=TRUE)$ix
ds <- nations %>% filter(NationCode=="DS") %>% arrange(Long)
test <- dist(select(ds, Long, Lat), method = "euclidean", upper = FALSE, p = 2)
test <- as.matrix(test)
ds$n <- sort.int(test[1,], index.return=TRUE)$ix
ds <- ds %>% arrange(n)
ggplot(filter(map2016, NationCode=="DS"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(ds),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ds <- nations %>% filter(NationCode=="DS") %>% arrange(Long)
ggplot(filter(map2016, NationCode=="DS"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(ds),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ds <- nations %>% filter(NationCode=="DS")
ggplot(filter(map2016, NationCode=="DS"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(ds),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
write.csv(ds, file="ds.csv")
counties <- map_data("county")
load("~/Box Sync/Personal/polls2016/county2016.Rda")
View(county2016)
head(county2016)
head(county2016[!duplicated(county2016[1:3]),])
nrow(county2016[!duplicated(county2016[1:3]),])
nrow(county2016[!duplicated(county2016)])
head(map2016)
i=1
tmp <- filter(map2016, Long==Long[i], Lat==Lat[i])
tmp
length(unique(tmp$Nation))>1
load("~/Box Sync/Personal/polls2016/map2016.Rda")
map2016$nationBorder <- 0
for (i in 1:nrow(map2016)) {
# identify points of intersection
tmp <- filter(map2016, Long==Long[i], Lat==Lat[i])
# identify if those intersection points are across nations
if (length(unique(tmp$Nation))==1) {
map2016$nationBorder[i] <- 0
}
print(i/nrow(map2016))
}
map2016$nationBorder <- 1
for (i in 1:nrow(map2016)) {
# identify points of intersection
tmp <- filter(map2016, Long==Long[i], Lat==Lat[i])
# identify if those intersection points are across nations
if (length(unique(tmp$Nation))==1) {
map2016$nationBorder[i] <- 0
}
print(i/nrow(map2016))
}
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=diff_2016), color="white", size=.1) +
geom_polygon(data=states, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_polygon(data=country, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_path(data=nations, aes(Long, Lat, group=Group), colour = "black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=diff_2016), color="white", size=.1) +
geom_polygon(data=states, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_polygon(data=country, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_path(data=counties, aes(Long, Lat, group=Group), colour = "black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
colnames(counties) <- c("Long", "Lat", "Group", "Order", "state", "county")
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=diff_2016), color="white", size=.1) +
geom_path(aes(Long, Lat, group=Group), colour = "black", size=.2) +
# geom_polygon(data=states, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_polygon(data=country, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_path(data=nations, aes(Long, Lat, group=Group), colour = "black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
map2016$nationBorder <- 1
for (i in 1:nrow(map2016)) {
# identify points of intersection
tmp <- filter(map2016, Long==Long[i], Lat==Lat[i])
# identify if those intersection points are across nations
if (length(unique(tmp$Nation))==1) {
map2016$nationBorder[i] <- 0
}
print(i/nrow(map2016))
}
View(map2016)
View(counties)
map2016$nationBorder <- 1
for (i in 1:nrow(map2016)) {
# identify points of intersection
tmp <- filter(map2016, Long==Long[i], Lat==Lat[i])
# identify if those intersection points are across nations
if (length(unique(tmp$Nation))==1) {
map2016$nationBorder[i] <- 0
}
print(i/nrow(map2016))
}
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=diff_2016), color="white", size=.1) +
# geom_polygon(data=states, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_polygon(data=country, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_path(data=filter(nations, nationBorder==1), aes(Long, Lat, group=Group), colour = "black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
head(map2016)
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=diff_2016), color="white", size=.1) +
# geom_polygon(data=states, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_polygon(data=country, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_path(data=filter(map2016, nationBorder==1), aes(Long, Lat, group=Group), colour = "black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
head(counties)
tail(counties)
View(counties)
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=diff_2016), color="white", size=.1) +
# geom_polygon(data=states, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_polygon(data=country, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_path(data=filter(map2016, nationBorder==1) %>% arrange(Order), aes(Long, Lat, group=Group), colour = "black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=diff_2016), color="white", size=.1) +
# geom_polygon(data=states, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_polygon(data=country, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_polygon(data=filter(map2016, nationBorder==1) %>% arrange(Order), aes(Long, Lat, group=Group), colour = "black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(filter(map2016, NationCode=="DS"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(ds),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
library(tidyverse)
library(maps)
library(geosphere)
library(RColorBrewer)
library(scales)
load("~/Box Sync/Personal/polls2016/map2016.Rda")
load("~/Box Sync/Personal/polls2016/nations.Rda")
country <- map_data("usa") # us border
states <- map_data("state") # state borders
ds <- nations %>% filter(NationCode=="DS") %>% arrange(Long)
ggplot(filter(map2016, NationCode=="DS"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(ds),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=diff_2016), color="white", size=.1) +
# geom_polygon(data=states, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_polygon(data=country, aes(long, lat, group=group), fill=NA, colour = "black", size=.2) +
geom_path(data=nations, aes(Long, Lat, group=Group), colour = "black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=Nation, alpha=diff_2016), colour = "white", size=.1) +
coord_map("bonne", param=45) +
theme_void()
ggplot(map2016, aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=Nation, alpha=diff_2016), colour = "white", size=.1) +
coord_map("bonne", param=45) +
theme_void()
ggplot(filter(map2016, NationCode=="DS"), aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=Nation, alpha=diff_2016), colour = "white", size=.1) +
coord_map("bonne", param=45) +
theme_void()
ggplot(filter(map2016, NationCode %in% c("DS", "TW")), aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=Nation, alpha=diff_2016), colour = "white", size=.1) +
coord_map("bonne", param=45) +
theme_void()
ggplot(filter(map2016, NationCode %in% c("DS", "TW", "NF")), aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=Nation, alpha=diff_2016), colour = "white", size=.1) +
coord_map("bonne", param=45) +
theme_void()
unique(map2016$NationCode)
unique(map2016$Nation)
ggplot(filter(map2016, Nation %in% c("Deep South", "New France", "New France-Deep South")), aes(Long, Lat)) +
geom_polygon(aes(group=Group, fill=Nation, alpha=diff_2016), colour = "white", size=.1) +
coord_map("bonne", param=45) +
theme_void()
ml <- nations %>% filter(NationCode=="ML")
test <- dist(select(ml, Long, Lat), method = "euclidean", upper = FALSE, p = 2)
test <- as.matrix(test)
ml$n <- sort.int(test[1,], index.return=TRUE)$ix
ml <- ml %>% arrange(n)
ggplot(filter(map2016, NationCode=="ML"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(ml),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
ml <- nations %>% filter(NationCode=="ML")
ggplot(filter(map2016, NationCode=="ML"), aes(Long, Lat)) +
geom_polygon(aes(group=Group), fill="grey", colour=NA, size=.2) +
# geom_polygon(data=nations, aes(group=Nation), colour="black", size=2) +
geom_path(data=filter(ml),colour="black", size=.2) +
coord_map("bonne", param=45) +
scale_fill_gradient2(high=c("#3399FF"), mid="white", low=c("#FF3333")) +
theme_void()
write.csv(ml, file="ml.csv")
